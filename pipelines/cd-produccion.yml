trigger:
  - Produccion

variables:
  - group: GitHubSecrets

pool:
  name: 'Default'

steps:
# Paso 1: Verificar el agente
- script: echo 'Iniciando Deploy a Producci贸n...'
  displayName: 'Verificar Agente'

# Paso 2: Despliegue (puedes personalizar seg煤n el servicio que uses)
#- task: AzureWebApp@1
#  inputs:
#    azureSubscription: '<NOMBRE-CONEXIN-SERVICIO>'
#    appName: '<NOMBRE-WEBAPP>'
#    package: '$(System.DefaultWorkingDirectory)/**/*.zip'
#  displayName: 'Desplegar a Producci贸n'

# Paso 3: Notificaci贸n final
- script: echo " Despliegue completado en Producci贸n"
  displayName: 'Finalizaci贸n del Deploy'

- script: |
    git config --global user.email "dvegacajas2@gmail.com"
    git config --global user.name "Diego Vega"

    git clone --mirror $(Build.Repository.Uri) repo-tmp
    cd repo-tmp

    git remote add github https://$(GITHUB_TOKEN):x-oauth-basic@github.com/diegovski02/ProyNaVishe_BACK.git
    git push github --mirror
  displayName: "Push autom谩tico a GitHub desde Azure"
  condition: and(succeeded(), eq(variables['Build.SourceBranchName'], 'Produccion'))
